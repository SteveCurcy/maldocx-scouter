# maldocx-scouter
@author : Steve Curcy  
@E-mail : steve_curcy@163.com  
@system : Debian 11  
@kernel version : 5.10  
@version: v1.0.0.221010_alpha_a1_SteveC  
  
**NOTE:** The program is a simple sample code now. It can only process the file downloading flows generated by docker 
httpd server.  
  
This code is used to find suspicious mal-document in the network flows. We will try to use eBPF to implement it.
At first, I wanna use ebpf XDP to do it, but XDP cannot do complex judgements and access for data is limited. So,
lately I try the TC (traffic control), whose data has been processed by os kernel. We can use `load_byte, load_half,
 load_word` to read data from skb (socket buffer) and the code can make a precise checking. BUT there may have some
other limitations like loop-times. Now I meet this problem and so I can only know if there a zip file in the packet
and check if that is a document file in the python script. It must be slower than handle all operations in kernel.  
  
Version naming rules: Major_Version_Number.Minor_Version_Number\[.Revision_Number\[.Build_Number\]\]  
Major_Version_Number: a huge change occurs and no backward compatibility  
Minor_Version_Number: a new function added with backward compatibility  
Revision_Number: some code revised or some bugs fixed  
Build_Number: just for developer and the following format is recommended: 
date-number_phase-number_revise-times_developer-abbreviation, e.g. 1.0.1.150325_beta_b3_SteveC
  
## USAGE
you will see the help message below when inputting `./tc_doc_log.py -h`:  
```c
usage: tc_doc_log.py [-h] [-v] [-i INTERFACE]

optional arguments:
  -h, --help            show this help message and exit
  -v, --verbose         Print the details of the document. This option will
                        bring a lot of time cost and is not recommended.
  -i INTERFACE, --interface INTERFACE
                        Specify a interface you want to monitor, container's
                        veth or ens33 will be the default choice.
  -p PORT, --port PORT  Specify the server's port you want to monitor, 80 is
                        the default value, but the server's port may be
                        modified and need you to point
```
There, you can specify a special interface by using option '-i'. The code will find the 'veth' at first and use 'ens33' 
by default if there is no 'veth'. So I provide this option just in case that your PC has no 'veth' and 'ens33'.  
By option '-v', you can get a program with more words who will tell you the detail of captured document, like files 
in it, file's size and so on. This DEBUG option is more likely for developer to now the global data.  
Option '-p' is to modify the port you want to monitor. 80 port will be monitored by default but some server will change 
its opened port for HTTP. So, there, I provide this power for you.